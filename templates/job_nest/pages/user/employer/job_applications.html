{% extends 'components/base.html' %}

{% load static %}


{% block title %}
    Job Applications
{% endblock %}
    

{% block content %}

<style>
    body {
        font-family: 'Inter', sans-serif;
        background-color: #f3f4f6;
    }
</style>

<main class="container mx-auto px-6 py-12 flex-grow">
    <div class="max-w-4xl mx-auto bg-white p-8 rounded-2xl shadow-xl">
        <h1 id="job-title" class="text-3xl font-bold text-center text-gray-800 mb-8">Applicants for: [Job Title]</h1>
        
        <!-- Applicants List -->
        <div id="applicant-list" class="space-y-6">
            <!-- Example Applicant Item (will be generated by JS or Django template loop) -->
            <!-- Example 1 -->
            <div class="p-6 rounded-lg bg-gray-50 shadow flex items-center justify-between">
                <div>
                    <h3 class="font-semibold text-gray-800 text-lg">John Doe</h3>
                    <p class="text-sm text-gray-500">Applied: 1 day ago</p>
                </div>
                <div class="text-sm text-right">
                    <p class="text-gray-700">Desired Salary: $85,000</p>
                    <p class="text-gray-700 mt-1">Availability: Full-time</p>
                </div>
            </div>
        </div>

        <!-- Pagination Controls -->
        <div id="pagination-controls" class="flex justify-center items-center space-x-2 mt-8">
            <button id="prev-page" class="bg-white px-4 py-2 rounded-lg text-gray-700 font-semibold border border-gray-300 hover:bg-gray-200 transition-colors duration-200 focus:outline-none">
                Previous
            </button>
            <div id="page-numbers" class="flex space-x-2">
                <!-- Page numbers will be generated here -->
            </div>
            <button id="next-page" class="bg-white px-4 py-2 rounded-lg text-gray-700 font-semibold border border-gray-300 hover:bg-gray-200 transition-colors duration-200 focus:outline-none">
                Next
            </button>
        </div>
    </div>
</main>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');

        mobileMenuBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });
        
        // Placeholder data for demonstration.
        // In a real application, you'd fetch this dynamically based on the job_id from the URL.
        const urlParams = new URLSearchParams(window.location.search);
        const jobId = urlParams.get('job_id');
        const allApplicants = [
            { name: 'John Doe', applied: '1 day ago', salary: '$85,000', availability: 'Full-time' },
            { name: 'Jane Smith', applied: '2 days ago', salary: '$90,000', availability: 'Full-time' },
            { name: 'Peter Jones', applied: '3 days ago', salary: '$75,000', availability: 'Part-time' },
            { name: 'Sarah Lee', applied: '4 days ago', salary: '$82,000', availability: 'Full-time' },
            { name: 'Mark Chen', applied: '5 days ago', salary: '$95,000', availability: 'Full-time' },
            { name: 'Lisa Rodriguez', applied: '6 days ago', salary: '$88,000', availability: 'Contract' },
            { name: 'Kevin Brown', applied: '1 week ago', salary: '$78,000', availability: 'Full-time' },
        ];
        const jobTitle = "Senior Software Engineer"; // Placeholder, would be fetched from database

        const applicantsPerPage = 5;
        let currentPage = 1;
        
        const applicantList = document.getElementById('applicant-list');
        const prevButton = document.getElementById('prev-page');
        const nextButton = document.getElementById('next-page');
        const pageNumbersDiv = document.getElementById('page-numbers');
        const jobTitleElement = document.getElementById('job-title');

        jobTitleElement.textContent = `Applicants for: ${jobTitle}`;

        function renderApplicants() {
            const startIndex = (currentPage - 1) * applicantsPerPage;
            const endIndex = startIndex + applicantsPerPage;
            const applicantsToRender = allApplicants.slice(startIndex, endIndex);

            applicantList.innerHTML = '';
            if (applicantsToRender.length === 0) {
                applicantList.innerHTML = '<p class="text-center text-gray-500">No applicants for this job yet.</p>';
                return;
            }

            applicantsToRender.forEach(applicant => {
                const applicantItem = document.createElement('div');
                applicantItem.className = 'p-6 rounded-lg bg-gray-50 shadow flex items-center justify-between';
                applicantItem.innerHTML = `
                    <div>
                        <h3 class="font-semibold text-gray-800 text-lg">${applicant.name}</h3>
                        <p class="text-sm text-gray-500">Applied: ${applicant.applied}</p>
                    </div>
                    <div class="text-sm text-right">
                        <p class="text-gray-700">Desired Salary: ${applicant.salary}</p>
                        <p class="text-gray-700 mt-1">Availability: ${applicant.availability}</p>
                    </div>
                `;
                applicantList.appendChild(applicantItem);
            });
            
            renderPaginationControls();
        }

        function renderPaginationControls() {
            const totalPages = Math.ceil(allApplicants.length / applicantsPerPage);
            pageNumbersDiv.innerHTML = '';

            // Previous button state
            prevButton.disabled = currentPage === 1;
            prevButton.classList.toggle('opacity-50', currentPage === 1);

            // Page number links
            for (let i = 1; i <= totalPages; i++) {
                const pageLink = document.createElement('a');
                pageLink.href = '#';
                pageLink.textContent = i;
                pageLink.className = `px-3 py-1 rounded-lg font-semibold transition-colors duration-200 ${
                    i === currentPage ? 'bg-indigo-600 text-white' : 'text-gray-700 bg-white hover:bg-gray-200'
                }`;
                pageLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    currentPage = i;
                    renderApplicants();
                });
                pageNumbersDiv.appendChild(pageLink);
            }

            // Next button state
            nextButton.disabled = currentPage === totalPages;
            nextButton.classList.toggle('opacity-50', currentPage === totalPages);
        }

        prevButton.addEventListener('click', () => {
            if (currentPage > 1) {
                currentPage--;
                renderApplicants();
            }
        });

        nextButton.addEventListener('click', () => {
            const totalPages = Math.ceil(allApplicants.length / applicantsPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                renderApplicants();
            }
        });

        // Initial render
        renderApplicants();
    });
</script>

{% endblock %}